<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Visor 3D con Colores Personalizables</title>
  <!-- LibrerÃ­a de <model-viewer> -->
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <style>
    body {
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      background: #111;
      color: white;
      font-family: Arial, sans-serif;
    }
    model-viewer {
      width: 100%;
      height: 80vh;
      background-color: #222; /* Fondo inicial */
    }
    .controls {
      margin: 15px;
      display: flex;
      gap: 30px;
    }
    label {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 18px;
    }
  </style>
</head>
<body>

  <!-- Visor 3D -->
  <model-viewer id="viewer"
    src="SE.glb"
    camera-controls
    auto-rotate
    shadow-intensity="1">
  </model-viewer>

  <!-- Controles -->
  <div class="controls">
    <label>
      ðŸ¤– Color del robot:
      <input type="color" id="objectColor" value="#00ff00">
    </label>
    <label>
      ðŸŒŒ Fondo:
      <input type="color" id="bgColor" value="#222222">
    </label>
  </div>

  <script>
    const viewer = document.getElementById("viewer");
    const objectColor = document.getElementById("objectColor");
    const bgColor = document.getElementById("bgColor");

    // Cuando se carga el modelo, lo pintamos de verde por defecto
    viewer.addEventListener("load", () => {
      const materials = viewer.model.materials;
      materials.forEach(mat => {
        mat.pbrMetallicRoughness.setBaseColorFactor([0, 1, 0, 1]); // Verde
      });
    });

    // Cambiar color del robot
    objectColor.addEventListener("input", (e) => {
      const hex = e.target.value;
      const rgb = hexToRgb(hex);
      const materials = viewer.model.materials;
      materials.forEach(mat => {
        mat.pbrMetallicRoughness.setBaseColorFactor([rgb.r / 255, rgb.g / 255, rgb.b / 255, 1]);
      });
    });

    // Cambiar color del fondo
    bgColor.addEventListener("input", (e) => {
      viewer.style.backgroundColor = e.target.value;
    });

    // FunciÃ³n auxiliar HEX â†’ RGB
    function hexToRgb(hex) {
      const bigint = parseInt(hex.slice(1), 16);
      return {
        r: (bigint >> 16) & 255,
        g: (bigint >> 8) & 255,
        b: bigint & 255
      };
    }
  </script>

</body>
</html>
